const statusEl=document.getElementById('status'),cur=document.getElementById('current'),fc=document.getElementById('forecast'),locEl=document.getElementById('loc');
function setStatus(s){if(statusEl)statusEl.textContent=s}async function j(u){const r=await fetch(u,{cache:'no-store'});if(!r.ok)throw new Error('HTTP '+r.status);return r.json()}
function render(d){const c=d.current||{},x=d.daily||{};if(d.location&&d.location.name)locEl.textContent=d.location.name;cur.innerHTML=`<div><strong>${c.summary||''}</strong> ${c.temperature!=null?(c.temperature+'°C'):''}</div><div class='muted'>${c.time||''}${c.wind?' · wind '+c.wind+' m/s':''}${c.humidity!=null?' · '+Math.round(c.humidity*100)+'%':''}</div>`;if(x.time&&x.max&&x.min){const rows=x.time.slice(0,5).map((t,i)=>`<div>${t}: ${x.min[i]}°C / ${x.max[i]}°C</div>`).join('');fc.innerHTML=`<h2 style='font-size:16px;margin:0 0 6px 0;'>Next days</h2>${rows}`}else{fc.innerHTML=`<span class='muted'>No forecast data</span>`}}(async()=>{try{const d=await j('../data/weather.json');render(d);setStatus('Data file');return}catch{}setStatus('Missing data/weather.json')})();