const statusEl=document.getElementById('status'),list=document.getElementById('list'),locEl=document.getElementById('loc');
function setStatus(s){if(statusEl)statusEl.textContent=s}async function j(u){const r=await fetch(u,{cache:'no-store'});if(!r.ok)throw new Error('HTTP '+r.status);return r.json()}
function render(items,station){if(station)locEl.textContent=station;if(!Array.isArray(items)||!items.length){list.innerHTML='<div class="muted">No tide data</div>';return}const rows=items.slice(0,8).map(it=>`<div>${it.time} — <strong>${it.type}</strong> ${it.height!=null?('· '+it.height+' m'):''}</div>`).join('');list.innerHTML=rows}
;(async()=>{try{const d=await j('../data/tides.json');render(d.tides||d.items||d,d.station||'Falmouth');setStatus('Data file')}catch{setStatus('Missing data/tides.json')}})();